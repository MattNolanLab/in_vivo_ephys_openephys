This folder contains the scripts for analysis. The execution sequence of those scripts are determined by a workflow file in `workflow/`

### Coding convention
Each script file should begin with a number that roughly indicate its order of execution. e.g. `01_xxx.py`. 

Scripts common for all analysis should be put in the top folder, whereas scripts specific for a particular experiment should be put into its own separate folder. It is recommended to create sub-folders for special analysis scripts for a particular experimental design. e.g. if you are working with optotagging with openfield data, it will be a good idea to put them under `scripts/openfield/opto` folder.

Scipts files are only intended to "glue" analysis functions together. In other words, it should only call functions defined elsewhere in the package. It should not perform the analysis or define those functions directly. This is to ensure each script file is clear to read and functions can be easily re-used across experiments. If you find yourself writing more than 2-3 lines of numpy/pandas code in a script file, you are probably doing it wrong. The detailed implementation of analysis function should be in the `PostSorting`, `PreSorting` etc. folders.

Each script file begins with a call to a SnakeHelper class. This class is designed to parse the workflow file and extract the input and output files name from the workflow. All functions in the scripts should use the filenames returned from the `getSnake` function. The `soutput` and `sinput` variables correspond to the output and input files of a rule respectively. You should not use any hard-coded value in your scripts directly. If you want to add a hard-coded value, add it in the `settings.py` and import in your script. This is so that we can keep track of all output files of a scripts such that snakemake can help us determine whether a rule needs to be re-run, and which input of a scripts depend on the output of the others.

Avoid writing a script file that is too long, both in term of lines of code or execution time. Each script is associated with a rule in the workflow. If a script file is too long, that means if there is some error happened on that rule, you need to run the whole file again. It is a good coding practice to break down a long script file into smaller ones so you can work on each part of the analysis incrementally. 

### Development and debugging 
Another useful feature of the `getSnake` function is that it allow you to run a script independently of the whole pipeline. For example, you can indicate which recording you want to work on using the `debug_folder` variable in the `settings.py`. Then when you run a particular script, `getSnake` will get the correct input and output file names automatically. You can then focus on developing or debugging that script, without always needing to invoke the entire pipeline. And since it is an independent scripts, you can easily use a debugger on it. Working in this way can improve your productivity dramatically because you are basically working in a small isolated environment. You can iterate on your code much faster. Each section of the script file is marked by a cell marker `#%%`. The cell marker allows you to run each section of code indepdently. It is very useful for debugging and development. The cell marker should be supported in VS Code of scientific mode in PyCharm.
